{"ast":null,"code":"define(['jquery', './utils'], function ($, Utils) {\n  function Results($element, options, dataAdapter) {\n    this.$element = $element;\n    this.data = dataAdapter;\n    this.options = options;\n\n    Results.__super__.constructor.call(this);\n  }\n\n  Utils.Extend(Results, Utils.Observable);\n\n  Results.prototype.render = function () {\n    var $results = $('<ul class=\"select2-results__options\" role=\"listbox\"></ul>');\n\n    if (this.options.get('multiple')) {\n      $results.attr('aria-multiselectable', 'true');\n    }\n\n    this.$results = $results;\n    return $results;\n  };\n\n  Results.prototype.clear = function () {\n    this.$results.empty();\n  };\n\n  Results.prototype.displayMessage = function (params) {\n    var escapeMarkup = this.options.get('escapeMarkup');\n    this.clear();\n    this.hideLoading();\n    var $message = $('<li role=\"alert\" aria-live=\"assertive\"' + ' class=\"select2-results__option\"></li>');\n    var message = this.options.get('translations').get(params.message);\n    $message.append(escapeMarkup(message(params.args)));\n    $message[0].className += ' select2-results__message';\n    this.$results.append($message);\n  };\n\n  Results.prototype.hideMessages = function () {\n    this.$results.find('.select2-results__message').remove();\n  };\n\n  Results.prototype.append = function (data) {\n    this.hideLoading();\n    var $options = [];\n\n    if (data.results == null || data.results.length === 0) {\n      if (this.$results.children().length === 0) {\n        this.trigger('results:message', {\n          message: 'noResults'\n        });\n      }\n\n      return;\n    }\n\n    data.results = this.sort(data.results);\n\n    for (var d = 0; d < data.results.length; d++) {\n      var item = data.results[d];\n      var $option = this.option(item);\n      $options.push($option);\n    }\n\n    this.$results.append($options);\n  };\n\n  Results.prototype.position = function ($results, $dropdown) {\n    var $resultsContainer = $dropdown.find('.select2-results');\n    $resultsContainer.append($results);\n  };\n\n  Results.prototype.sort = function (data) {\n    var sorter = this.options.get('sorter');\n    return sorter(data);\n  };\n\n  Results.prototype.highlightFirstItem = function () {\n    var $options = this.$results.find('.select2-results__option[aria-selected]');\n    var $selected = $options.filter('[aria-selected=true]'); // Check if there are any selected options\n\n    if ($selected.length > 0) {\n      // If there are selected options, highlight the first\n      $selected.first().trigger('mouseenter');\n    } else {\n      // If there are no selected options, highlight the first option\n      // in the dropdown\n      $options.first().trigger('mouseenter');\n    }\n\n    this.ensureHighlightVisible();\n  };\n\n  Results.prototype.setClasses = function () {\n    var self = this;\n    this.data.current(function (selected) {\n      var selectedIds = $.map(selected, function (s) {\n        return s.id.toString();\n      });\n      var $options = self.$results.find('.select2-results__option[aria-selected]');\n      $options.each(function () {\n        var $option = $(this);\n        var item = Utils.GetData(this, 'data'); // id needs to be converted to a string when comparing\n\n        var id = '' + item.id;\n\n        if (item.element != null && item.element.selected || item.element == null && $.inArray(id, selectedIds) > -1) {\n          $option.attr('aria-selected', 'true');\n        } else {\n          $option.attr('aria-selected', 'false');\n        }\n      });\n    });\n  };\n\n  Results.prototype.showLoading = function (params) {\n    this.hideLoading();\n    var loadingMore = this.options.get('translations').get('searching');\n    var loading = {\n      disabled: true,\n      loading: true,\n      text: loadingMore(params)\n    };\n    var $loading = this.option(loading);\n    $loading.className += ' loading-results';\n    this.$results.prepend($loading);\n  };\n\n  Results.prototype.hideLoading = function () {\n    this.$results.find('.loading-results').remove();\n  };\n\n  Results.prototype.option = function (data) {\n    var option = document.createElement('li');\n    option.className = 'select2-results__option';\n    var attrs = {\n      'role': 'option',\n      'aria-selected': 'false'\n    };\n    var matches = window.Element.prototype.matches || window.Element.prototype.msMatchesSelector || window.Element.prototype.webkitMatchesSelector;\n\n    if (data.element != null && matches.call(data.element, ':disabled') || data.element == null && data.disabled) {\n      delete attrs['aria-selected'];\n      attrs['aria-disabled'] = 'true';\n    }\n\n    if (data.id == null) {\n      delete attrs['aria-selected'];\n    }\n\n    if (data._resultId != null) {\n      option.id = data._resultId;\n    }\n\n    if (data.title) {\n      option.title = data.title;\n    }\n\n    if (data.children) {\n      attrs.role = 'group';\n      attrs['aria-label'] = data.text;\n      delete attrs['aria-selected'];\n    }\n\n    for (var attr in attrs) {\n      var val = attrs[attr];\n      option.setAttribute(attr, val);\n    }\n\n    if (data.children) {\n      var $option = $(option);\n      var label = document.createElement('strong');\n      label.className = 'select2-results__group';\n      var $label = $(label);\n      this.template(data, label);\n      var $children = [];\n\n      for (var c = 0; c < data.children.length; c++) {\n        var child = data.children[c];\n        var $child = this.option(child);\n        $children.push($child);\n      }\n\n      var $childrenContainer = $('<ul></ul>', {\n        'class': 'select2-results__options select2-results__options--nested'\n      });\n      $childrenContainer.append($children);\n      $option.append(label);\n      $option.append($childrenContainer);\n    } else {\n      this.template(data, option);\n    }\n\n    Utils.StoreData(option, 'data', data);\n    return option;\n  };\n\n  Results.prototype.bind = function (container, $container) {\n    var self = this;\n    var id = container.id + '-results';\n    this.$results.attr('id', id);\n    container.on('results:all', function (params) {\n      self.clear();\n      self.append(params.data);\n\n      if (container.isOpen()) {\n        self.setClasses();\n        self.highlightFirstItem();\n      }\n    });\n    container.on('results:append', function (params) {\n      self.append(params.data);\n\n      if (container.isOpen()) {\n        self.setClasses();\n      }\n    });\n    container.on('query', function (params) {\n      self.hideMessages();\n      self.showLoading(params);\n    });\n    container.on('select', function () {\n      if (!container.isOpen()) {\n        return;\n      }\n\n      self.setClasses();\n\n      if (self.options.get('scrollAfterSelect')) {\n        self.highlightFirstItem();\n      }\n    });\n    container.on('unselect', function () {\n      if (!container.isOpen()) {\n        return;\n      }\n\n      self.setClasses();\n\n      if (self.options.get('scrollAfterSelect')) {\n        self.highlightFirstItem();\n      }\n    });\n    container.on('open', function () {\n      // When the dropdown is open, aria-expended=\"true\"\n      self.$results.attr('aria-expanded', 'true');\n      self.$results.attr('aria-hidden', 'false');\n      self.setClasses();\n      self.ensureHighlightVisible();\n    });\n    container.on('close', function () {\n      // When the dropdown is closed, aria-expended=\"false\"\n      self.$results.attr('aria-expanded', 'false');\n      self.$results.attr('aria-hidden', 'true');\n      self.$results.removeAttr('aria-activedescendant');\n    });\n    container.on('results:toggle', function () {\n      var $highlighted = self.getHighlightedResults();\n\n      if ($highlighted.length === 0) {\n        return;\n      }\n\n      $highlighted.trigger('mouseup');\n    });\n    container.on('results:select', function () {\n      var $highlighted = self.getHighlightedResults();\n\n      if ($highlighted.length === 0) {\n        return;\n      }\n\n      var data = Utils.GetData($highlighted[0], 'data');\n\n      if ($highlighted.attr('aria-selected') == 'true') {\n        self.trigger('close', {});\n      } else {\n        self.trigger('select', {\n          data: data\n        });\n      }\n    });\n    container.on('results:previous', function () {\n      var $highlighted = self.getHighlightedResults();\n      var $options = self.$results.find('[aria-selected]');\n      var currentIndex = $options.index($highlighted); // If we are already at the top, don't move further\n      // If no options, currentIndex will be -1\n\n      if (currentIndex <= 0) {\n        return;\n      }\n\n      var nextIndex = currentIndex - 1; // If none are highlighted, highlight the first\n\n      if ($highlighted.length === 0) {\n        nextIndex = 0;\n      }\n\n      var $next = $options.eq(nextIndex);\n      $next.trigger('mouseenter');\n      var currentOffset = self.$results.offset().top;\n      var nextTop = $next.offset().top;\n      var nextOffset = self.$results.scrollTop() + (nextTop - currentOffset);\n\n      if (nextIndex === 0) {\n        self.$results.scrollTop(0);\n      } else if (nextTop - currentOffset < 0) {\n        self.$results.scrollTop(nextOffset);\n      }\n    });\n    container.on('results:next', function () {\n      var $highlighted = self.getHighlightedResults();\n      var $options = self.$results.find('[aria-selected]');\n      var currentIndex = $options.index($highlighted);\n      var nextIndex = currentIndex + 1; // If we are at the last option, stay there\n\n      if (nextIndex >= $options.length) {\n        return;\n      }\n\n      var $next = $options.eq(nextIndex);\n      $next.trigger('mouseenter');\n      var currentOffset = self.$results.offset().top + self.$results.outerHeight(false);\n      var nextBottom = $next.offset().top + $next.outerHeight(false);\n      var nextOffset = self.$results.scrollTop() + nextBottom - currentOffset;\n\n      if (nextIndex === 0) {\n        self.$results.scrollTop(0);\n      } else if (nextBottom > currentOffset) {\n        self.$results.scrollTop(nextOffset);\n      }\n    });\n    container.on('results:focus', function (params) {\n      params.element.addClass('select2-results__option--highlighted');\n    });\n    container.on('results:message', function (params) {\n      self.displayMessage(params);\n    });\n\n    if ($.fn.mousewheel) {\n      this.$results.on('mousewheel', function (e) {\n        var top = self.$results.scrollTop();\n        var bottom = self.$results.get(0).scrollHeight - top + e.deltaY;\n        var isAtTop = e.deltaY > 0 && top - e.deltaY <= 0;\n        var isAtBottom = e.deltaY < 0 && bottom <= self.$results.height();\n\n        if (isAtTop) {\n          self.$results.scrollTop(0);\n          e.preventDefault();\n          e.stopPropagation();\n        } else if (isAtBottom) {\n          self.$results.scrollTop(self.$results.get(0).scrollHeight - self.$results.height());\n          e.preventDefault();\n          e.stopPropagation();\n        }\n      });\n    }\n\n    this.$results.on('mouseup', '.select2-results__option[aria-selected]', function (evt) {\n      var $this = $(this);\n      var data = Utils.GetData(this, 'data');\n\n      if ($this.attr('aria-selected') === 'true') {\n        if (self.options.get('multiple')) {\n          self.trigger('unselect', {\n            originalEvent: evt,\n            data: data\n          });\n        } else {\n          self.trigger('close', {});\n        }\n\n        return;\n      }\n\n      self.trigger('select', {\n        originalEvent: evt,\n        data: data\n      });\n    });\n    this.$results.on('mouseenter', '.select2-results__option[aria-selected]', function (evt) {\n      var data = Utils.GetData(this, 'data');\n      self.getHighlightedResults().removeClass('select2-results__option--highlighted');\n      self.trigger('results:focus', {\n        data: data,\n        element: $(this)\n      });\n    });\n  };\n\n  Results.prototype.getHighlightedResults = function () {\n    var $highlighted = this.$results.find('.select2-results__option--highlighted');\n    return $highlighted;\n  };\n\n  Results.prototype.destroy = function () {\n    this.$results.remove();\n  };\n\n  Results.prototype.ensureHighlightVisible = function () {\n    var $highlighted = this.getHighlightedResults();\n\n    if ($highlighted.length === 0) {\n      return;\n    }\n\n    var $options = this.$results.find('[aria-selected]');\n    var currentIndex = $options.index($highlighted);\n    var currentOffset = this.$results.offset().top;\n    var nextTop = $highlighted.offset().top;\n    var nextOffset = this.$results.scrollTop() + (nextTop - currentOffset);\n    var offsetDelta = nextTop - currentOffset;\n    nextOffset -= $highlighted.outerHeight(false) * 2;\n\n    if (currentIndex <= 2) {\n      this.$results.scrollTop(0);\n    } else if (offsetDelta > this.$results.outerHeight() || offsetDelta < 0) {\n      this.$results.scrollTop(nextOffset);\n    }\n  };\n\n  Results.prototype.template = function (result, container) {\n    var template = this.options.get('templateResult');\n    var escapeMarkup = this.options.get('escapeMarkup');\n    var content = template(result, container);\n\n    if (content == null) {\n      container.style.display = 'none';\n    } else if (typeof content === 'string') {\n      container.innerHTML = escapeMarkup(content);\n    } else {\n      $(container).append(content);\n    }\n  };\n\n  return Results;\n});","map":{"version":3,"sources":["/Users/albab/bookapro/amazon/src/assets/vendor/select2/src/js/select2/results.js"],"names":["define","$","Utils","Results","$element","options","dataAdapter","data","__super__","constructor","call","Extend","Observable","prototype","render","$results","get","attr","clear","empty","displayMessage","params","escapeMarkup","hideLoading","$message","message","append","args","className","hideMessages","find","remove","$options","results","length","children","trigger","sort","d","item","$option","option","push","position","$dropdown","$resultsContainer","sorter","highlightFirstItem","$selected","filter","first","ensureHighlightVisible","setClasses","self","current","selected","selectedIds","map","s","id","toString","each","GetData","element","inArray","showLoading","loadingMore","loading","disabled","text","$loading","prepend","document","createElement","attrs","matches","window","Element","msMatchesSelector","webkitMatchesSelector","_resultId","title","role","val","setAttribute","label","$label","template","$children","c","child","$child","$childrenContainer","StoreData","bind","container","$container","on","isOpen","removeAttr","$highlighted","getHighlightedResults","currentIndex","index","nextIndex","$next","eq","currentOffset","offset","top","nextTop","nextOffset","scrollTop","outerHeight","nextBottom","addClass","fn","mousewheel","e","bottom","scrollHeight","deltaY","isAtTop","isAtBottom","height","preventDefault","stopPropagation","evt","$this","originalEvent","removeClass","destroy","offsetDelta","result","content","style","display","innerHTML"],"mappings":"AAAAA,MAAM,CAAC,CACL,QADK,EAEL,SAFK,CAAD,EAGH,UAAUC,CAAV,EAAaC,KAAb,EAAoB;AACrB,WAASC,OAAT,CAAkBC,QAAlB,EAA4BC,OAA5B,EAAqCC,WAArC,EAAkD;AAChD,SAAKF,QAAL,GAAgBA,QAAhB;AACA,SAAKG,IAAL,GAAYD,WAAZ;AACA,SAAKD,OAAL,GAAeA,OAAf;;AAEAF,IAAAA,OAAO,CAACK,SAAR,CAAkBC,WAAlB,CAA8BC,IAA9B,CAAmC,IAAnC;AACD;;AAEDR,EAAAA,KAAK,CAACS,MAAN,CAAaR,OAAb,EAAsBD,KAAK,CAACU,UAA5B;;AAEAT,EAAAA,OAAO,CAACU,SAAR,CAAkBC,MAAlB,GAA2B,YAAY;AACrC,QAAIC,QAAQ,GAAGd,CAAC,CACd,2DADc,CAAhB;;AAIA,QAAI,KAAKI,OAAL,CAAaW,GAAb,CAAiB,UAAjB,CAAJ,EAAkC;AAChCD,MAAAA,QAAQ,CAACE,IAAT,CAAc,sBAAd,EAAsC,MAAtC;AACD;;AAED,SAAKF,QAAL,GAAgBA,QAAhB;AAEA,WAAOA,QAAP;AACD,GAZD;;AAcAZ,EAAAA,OAAO,CAACU,SAAR,CAAkBK,KAAlB,GAA0B,YAAY;AACpC,SAAKH,QAAL,CAAcI,KAAd;AACD,GAFD;;AAIAhB,EAAAA,OAAO,CAACU,SAAR,CAAkBO,cAAlB,GAAmC,UAAUC,MAAV,EAAkB;AACnD,QAAIC,YAAY,GAAG,KAAKjB,OAAL,CAAaW,GAAb,CAAiB,cAAjB,CAAnB;AAEA,SAAKE,KAAL;AACA,SAAKK,WAAL;AAEA,QAAIC,QAAQ,GAAGvB,CAAC,CACd,2CACA,wCAFc,CAAhB;AAKA,QAAIwB,OAAO,GAAG,KAAKpB,OAAL,CAAaW,GAAb,CAAiB,cAAjB,EAAiCA,GAAjC,CAAqCK,MAAM,CAACI,OAA5C,CAAd;AAEAD,IAAAA,QAAQ,CAACE,MAAT,CACEJ,YAAY,CACVG,OAAO,CAACJ,MAAM,CAACM,IAAR,CADG,CADd;AAMAH,IAAAA,QAAQ,CAAC,CAAD,CAAR,CAAYI,SAAZ,IAAyB,2BAAzB;AAEA,SAAKb,QAAL,CAAcW,MAAd,CAAqBF,QAArB;AACD,GAtBD;;AAwBArB,EAAAA,OAAO,CAACU,SAAR,CAAkBgB,YAAlB,GAAiC,YAAY;AAC3C,SAAKd,QAAL,CAAce,IAAd,CAAmB,2BAAnB,EAAgDC,MAAhD;AACD,GAFD;;AAIA5B,EAAAA,OAAO,CAACU,SAAR,CAAkBa,MAAlB,GAA2B,UAAUnB,IAAV,EAAgB;AACzC,SAAKgB,WAAL;AAEA,QAAIS,QAAQ,GAAG,EAAf;;AAEA,QAAIzB,IAAI,CAAC0B,OAAL,IAAgB,IAAhB,IAAwB1B,IAAI,CAAC0B,OAAL,CAAaC,MAAb,KAAwB,CAApD,EAAuD;AACrD,UAAI,KAAKnB,QAAL,CAAcoB,QAAd,GAAyBD,MAAzB,KAAoC,CAAxC,EAA2C;AACzC,aAAKE,OAAL,CAAa,iBAAb,EAAgC;AAC9BX,UAAAA,OAAO,EAAE;AADqB,SAAhC;AAGD;;AAED;AACD;;AAEDlB,IAAAA,IAAI,CAAC0B,OAAL,GAAe,KAAKI,IAAL,CAAU9B,IAAI,CAAC0B,OAAf,CAAf;;AAEA,SAAK,IAAIK,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG/B,IAAI,CAAC0B,OAAL,CAAaC,MAAjC,EAAyCI,CAAC,EAA1C,EAA8C;AAC5C,UAAIC,IAAI,GAAGhC,IAAI,CAAC0B,OAAL,CAAaK,CAAb,CAAX;AAEA,UAAIE,OAAO,GAAG,KAAKC,MAAL,CAAYF,IAAZ,CAAd;AAEAP,MAAAA,QAAQ,CAACU,IAAT,CAAcF,OAAd;AACD;;AAED,SAAKzB,QAAL,CAAcW,MAAd,CAAqBM,QAArB;AACD,GA1BD;;AA4BA7B,EAAAA,OAAO,CAACU,SAAR,CAAkB8B,QAAlB,GAA6B,UAAU5B,QAAV,EAAoB6B,SAApB,EAA+B;AAC1D,QAAIC,iBAAiB,GAAGD,SAAS,CAACd,IAAV,CAAe,kBAAf,CAAxB;AACAe,IAAAA,iBAAiB,CAACnB,MAAlB,CAAyBX,QAAzB;AACD,GAHD;;AAKAZ,EAAAA,OAAO,CAACU,SAAR,CAAkBwB,IAAlB,GAAyB,UAAU9B,IAAV,EAAgB;AACvC,QAAIuC,MAAM,GAAG,KAAKzC,OAAL,CAAaW,GAAb,CAAiB,QAAjB,CAAb;AAEA,WAAO8B,MAAM,CAACvC,IAAD,CAAb;AACD,GAJD;;AAMAJ,EAAAA,OAAO,CAACU,SAAR,CAAkBkC,kBAAlB,GAAuC,YAAY;AACjD,QAAIf,QAAQ,GAAG,KAAKjB,QAAL,CACZe,IADY,CACP,yCADO,CAAf;AAGA,QAAIkB,SAAS,GAAGhB,QAAQ,CAACiB,MAAT,CAAgB,sBAAhB,CAAhB,CAJiD,CAMjD;;AACA,QAAID,SAAS,CAACd,MAAV,GAAmB,CAAvB,EAA0B;AACxB;AACAc,MAAAA,SAAS,CAACE,KAAV,GAAkBd,OAAlB,CAA0B,YAA1B;AACD,KAHD,MAGO;AACL;AACA;AACAJ,MAAAA,QAAQ,CAACkB,KAAT,GAAiBd,OAAjB,CAAyB,YAAzB;AACD;;AAED,SAAKe,sBAAL;AACD,GAjBD;;AAmBAhD,EAAAA,OAAO,CAACU,SAAR,CAAkBuC,UAAlB,GAA+B,YAAY;AACzC,QAAIC,IAAI,GAAG,IAAX;AAEA,SAAK9C,IAAL,CAAU+C,OAAV,CAAkB,UAAUC,QAAV,EAAoB;AACpC,UAAIC,WAAW,GAAGvD,CAAC,CAACwD,GAAF,CAAMF,QAAN,EAAgB,UAAUG,CAAV,EAAa;AAC7C,eAAOA,CAAC,CAACC,EAAF,CAAKC,QAAL,EAAP;AACD,OAFiB,CAAlB;AAIA,UAAI5B,QAAQ,GAAGqB,IAAI,CAACtC,QAAL,CACZe,IADY,CACP,yCADO,CAAf;AAGAE,MAAAA,QAAQ,CAAC6B,IAAT,CAAc,YAAY;AACxB,YAAIrB,OAAO,GAAGvC,CAAC,CAAC,IAAD,CAAf;AAEA,YAAIsC,IAAI,GAAGrC,KAAK,CAAC4D,OAAN,CAAc,IAAd,EAAoB,MAApB,CAAX,CAHwB,CAKxB;;AACA,YAAIH,EAAE,GAAG,KAAKpB,IAAI,CAACoB,EAAnB;;AAEA,YAAKpB,IAAI,CAACwB,OAAL,IAAgB,IAAhB,IAAwBxB,IAAI,CAACwB,OAAL,CAAaR,QAAtC,IACChB,IAAI,CAACwB,OAAL,IAAgB,IAAhB,IAAwB9D,CAAC,CAAC+D,OAAF,CAAUL,EAAV,EAAcH,WAAd,IAA6B,CAAC,CAD3D,EAC+D;AAC7DhB,UAAAA,OAAO,CAACvB,IAAR,CAAa,eAAb,EAA8B,MAA9B;AACD,SAHD,MAGO;AACLuB,UAAAA,OAAO,CAACvB,IAAR,CAAa,eAAb,EAA8B,OAA9B;AACD;AACF,OAdD;AAgBD,KAxBD;AAyBD,GA5BD;;AA8BAd,EAAAA,OAAO,CAACU,SAAR,CAAkBoD,WAAlB,GAAgC,UAAU5C,MAAV,EAAkB;AAChD,SAAKE,WAAL;AAEA,QAAI2C,WAAW,GAAG,KAAK7D,OAAL,CAAaW,GAAb,CAAiB,cAAjB,EAAiCA,GAAjC,CAAqC,WAArC,CAAlB;AAEA,QAAImD,OAAO,GAAG;AACZC,MAAAA,QAAQ,EAAE,IADE;AAEZD,MAAAA,OAAO,EAAE,IAFG;AAGZE,MAAAA,IAAI,EAAEH,WAAW,CAAC7C,MAAD;AAHL,KAAd;AAKA,QAAIiD,QAAQ,GAAG,KAAK7B,MAAL,CAAY0B,OAAZ,CAAf;AACAG,IAAAA,QAAQ,CAAC1C,SAAT,IAAsB,kBAAtB;AAEA,SAAKb,QAAL,CAAcwD,OAAd,CAAsBD,QAAtB;AACD,GAdD;;AAgBAnE,EAAAA,OAAO,CAACU,SAAR,CAAkBU,WAAlB,GAAgC,YAAY;AAC1C,SAAKR,QAAL,CAAce,IAAd,CAAmB,kBAAnB,EAAuCC,MAAvC;AACD,GAFD;;AAIA5B,EAAAA,OAAO,CAACU,SAAR,CAAkB4B,MAAlB,GAA2B,UAAUlC,IAAV,EAAgB;AACzC,QAAIkC,MAAM,GAAG+B,QAAQ,CAACC,aAAT,CAAuB,IAAvB,CAAb;AACAhC,IAAAA,MAAM,CAACb,SAAP,GAAmB,yBAAnB;AAEA,QAAI8C,KAAK,GAAG;AACV,cAAQ,QADE;AAEV,uBAAiB;AAFP,KAAZ;AAKA,QAAIC,OAAO,GAAGC,MAAM,CAACC,OAAP,CAAehE,SAAf,CAAyB8D,OAAzB,IACZC,MAAM,CAACC,OAAP,CAAehE,SAAf,CAAyBiE,iBADb,IAEZF,MAAM,CAACC,OAAP,CAAehE,SAAf,CAAyBkE,qBAF3B;;AAIA,QAAKxE,IAAI,CAACwD,OAAL,IAAgB,IAAhB,IAAwBY,OAAO,CAACjE,IAAR,CAAaH,IAAI,CAACwD,OAAlB,EAA2B,WAA3B,CAAzB,IACCxD,IAAI,CAACwD,OAAL,IAAgB,IAAhB,IAAwBxD,IAAI,CAAC6D,QADlC,EAC6C;AAC3C,aAAOM,KAAK,CAAC,eAAD,CAAZ;AACAA,MAAAA,KAAK,CAAC,eAAD,CAAL,GAAyB,MAAzB;AACD;;AAED,QAAInE,IAAI,CAACoD,EAAL,IAAW,IAAf,EAAqB;AACnB,aAAOe,KAAK,CAAC,eAAD,CAAZ;AACD;;AAED,QAAInE,IAAI,CAACyE,SAAL,IAAkB,IAAtB,EAA4B;AAC1BvC,MAAAA,MAAM,CAACkB,EAAP,GAAYpD,IAAI,CAACyE,SAAjB;AACD;;AAED,QAAIzE,IAAI,CAAC0E,KAAT,EAAgB;AACdxC,MAAAA,MAAM,CAACwC,KAAP,GAAe1E,IAAI,CAAC0E,KAApB;AACD;;AAED,QAAI1E,IAAI,CAAC4B,QAAT,EAAmB;AACjBuC,MAAAA,KAAK,CAACQ,IAAN,GAAa,OAAb;AACAR,MAAAA,KAAK,CAAC,YAAD,CAAL,GAAsBnE,IAAI,CAAC8D,IAA3B;AACA,aAAOK,KAAK,CAAC,eAAD,CAAZ;AACD;;AAED,SAAK,IAAIzD,IAAT,IAAiByD,KAAjB,EAAwB;AACtB,UAAIS,GAAG,GAAGT,KAAK,CAACzD,IAAD,CAAf;AAEAwB,MAAAA,MAAM,CAAC2C,YAAP,CAAoBnE,IAApB,EAA0BkE,GAA1B;AACD;;AAED,QAAI5E,IAAI,CAAC4B,QAAT,EAAmB;AACjB,UAAIK,OAAO,GAAGvC,CAAC,CAACwC,MAAD,CAAf;AAEA,UAAI4C,KAAK,GAAGb,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAZ;AACAY,MAAAA,KAAK,CAACzD,SAAN,GAAkB,wBAAlB;AAEA,UAAI0D,MAAM,GAAGrF,CAAC,CAACoF,KAAD,CAAd;AACA,WAAKE,QAAL,CAAchF,IAAd,EAAoB8E,KAApB;AAEA,UAAIG,SAAS,GAAG,EAAhB;;AAEA,WAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGlF,IAAI,CAAC4B,QAAL,CAAcD,MAAlC,EAA0CuD,CAAC,EAA3C,EAA+C;AAC7C,YAAIC,KAAK,GAAGnF,IAAI,CAAC4B,QAAL,CAAcsD,CAAd,CAAZ;AAEA,YAAIE,MAAM,GAAG,KAAKlD,MAAL,CAAYiD,KAAZ,CAAb;AAEAF,QAAAA,SAAS,CAAC9C,IAAV,CAAeiD,MAAf;AACD;;AAED,UAAIC,kBAAkB,GAAG3F,CAAC,CAAC,WAAD,EAAc;AACtC,iBAAS;AAD6B,OAAd,CAA1B;AAIA2F,MAAAA,kBAAkB,CAAClE,MAAnB,CAA0B8D,SAA1B;AAEAhD,MAAAA,OAAO,CAACd,MAAR,CAAe2D,KAAf;AACA7C,MAAAA,OAAO,CAACd,MAAR,CAAekE,kBAAf;AACD,KA3BD,MA2BO;AACL,WAAKL,QAAL,CAAchF,IAAd,EAAoBkC,MAApB;AACD;;AAEDvC,IAAAA,KAAK,CAAC2F,SAAN,CAAgBpD,MAAhB,EAAwB,MAAxB,EAAgClC,IAAhC;AAEA,WAAOkC,MAAP;AACD,GA7ED;;AA+EAtC,EAAAA,OAAO,CAACU,SAAR,CAAkBiF,IAAlB,GAAyB,UAAUC,SAAV,EAAqBC,UAArB,EAAiC;AACxD,QAAI3C,IAAI,GAAG,IAAX;AAEA,QAAIM,EAAE,GAAGoC,SAAS,CAACpC,EAAV,GAAe,UAAxB;AAEA,SAAK5C,QAAL,CAAcE,IAAd,CAAmB,IAAnB,EAAyB0C,EAAzB;AAEAoC,IAAAA,SAAS,CAACE,EAAV,CAAa,aAAb,EAA4B,UAAU5E,MAAV,EAAkB;AAC5CgC,MAAAA,IAAI,CAACnC,KAAL;AACAmC,MAAAA,IAAI,CAAC3B,MAAL,CAAYL,MAAM,CAACd,IAAnB;;AAEA,UAAIwF,SAAS,CAACG,MAAV,EAAJ,EAAwB;AACtB7C,QAAAA,IAAI,CAACD,UAAL;AACAC,QAAAA,IAAI,CAACN,kBAAL;AACD;AACF,KARD;AAUAgD,IAAAA,SAAS,CAACE,EAAV,CAAa,gBAAb,EAA+B,UAAU5E,MAAV,EAAkB;AAC/CgC,MAAAA,IAAI,CAAC3B,MAAL,CAAYL,MAAM,CAACd,IAAnB;;AAEA,UAAIwF,SAAS,CAACG,MAAV,EAAJ,EAAwB;AACtB7C,QAAAA,IAAI,CAACD,UAAL;AACD;AACF,KAND;AAQA2C,IAAAA,SAAS,CAACE,EAAV,CAAa,OAAb,EAAsB,UAAU5E,MAAV,EAAkB;AACtCgC,MAAAA,IAAI,CAACxB,YAAL;AACAwB,MAAAA,IAAI,CAACY,WAAL,CAAiB5C,MAAjB;AACD,KAHD;AAKA0E,IAAAA,SAAS,CAACE,EAAV,CAAa,QAAb,EAAuB,YAAY;AACjC,UAAI,CAACF,SAAS,CAACG,MAAV,EAAL,EAAyB;AACvB;AACD;;AAED7C,MAAAA,IAAI,CAACD,UAAL;;AAEA,UAAIC,IAAI,CAAChD,OAAL,CAAaW,GAAb,CAAiB,mBAAjB,CAAJ,EAA2C;AACzCqC,QAAAA,IAAI,CAACN,kBAAL;AACD;AACF,KAVD;AAYAgD,IAAAA,SAAS,CAACE,EAAV,CAAa,UAAb,EAAyB,YAAY;AACnC,UAAI,CAACF,SAAS,CAACG,MAAV,EAAL,EAAyB;AACvB;AACD;;AAED7C,MAAAA,IAAI,CAACD,UAAL;;AAEA,UAAIC,IAAI,CAAChD,OAAL,CAAaW,GAAb,CAAiB,mBAAjB,CAAJ,EAA2C;AACzCqC,QAAAA,IAAI,CAACN,kBAAL;AACD;AACF,KAVD;AAYAgD,IAAAA,SAAS,CAACE,EAAV,CAAa,MAAb,EAAqB,YAAY;AAC/B;AACA5C,MAAAA,IAAI,CAACtC,QAAL,CAAcE,IAAd,CAAmB,eAAnB,EAAoC,MAApC;AACAoC,MAAAA,IAAI,CAACtC,QAAL,CAAcE,IAAd,CAAmB,aAAnB,EAAkC,OAAlC;AAEAoC,MAAAA,IAAI,CAACD,UAAL;AACAC,MAAAA,IAAI,CAACF,sBAAL;AACD,KAPD;AASA4C,IAAAA,SAAS,CAACE,EAAV,CAAa,OAAb,EAAsB,YAAY;AAChC;AACA5C,MAAAA,IAAI,CAACtC,QAAL,CAAcE,IAAd,CAAmB,eAAnB,EAAoC,OAApC;AACAoC,MAAAA,IAAI,CAACtC,QAAL,CAAcE,IAAd,CAAmB,aAAnB,EAAkC,MAAlC;AACAoC,MAAAA,IAAI,CAACtC,QAAL,CAAcoF,UAAd,CAAyB,uBAAzB;AACD,KALD;AAOAJ,IAAAA,SAAS,CAACE,EAAV,CAAa,gBAAb,EAA+B,YAAY;AACzC,UAAIG,YAAY,GAAG/C,IAAI,CAACgD,qBAAL,EAAnB;;AAEA,UAAID,YAAY,CAAClE,MAAb,KAAwB,CAA5B,EAA+B;AAC7B;AACD;;AAEDkE,MAAAA,YAAY,CAAChE,OAAb,CAAqB,SAArB;AACD,KARD;AAUA2D,IAAAA,SAAS,CAACE,EAAV,CAAa,gBAAb,EAA+B,YAAY;AACzC,UAAIG,YAAY,GAAG/C,IAAI,CAACgD,qBAAL,EAAnB;;AAEA,UAAID,YAAY,CAAClE,MAAb,KAAwB,CAA5B,EAA+B;AAC7B;AACD;;AAED,UAAI3B,IAAI,GAAGL,KAAK,CAAC4D,OAAN,CAAcsC,YAAY,CAAC,CAAD,CAA1B,EAA+B,MAA/B,CAAX;;AAEA,UAAIA,YAAY,CAACnF,IAAb,CAAkB,eAAlB,KAAsC,MAA1C,EAAkD;AAChDoC,QAAAA,IAAI,CAACjB,OAAL,CAAa,OAAb,EAAsB,EAAtB;AACD,OAFD,MAEO;AACLiB,QAAAA,IAAI,CAACjB,OAAL,CAAa,QAAb,EAAuB;AACrB7B,UAAAA,IAAI,EAAEA;AADe,SAAvB;AAGD;AACF,KAhBD;AAkBAwF,IAAAA,SAAS,CAACE,EAAV,CAAa,kBAAb,EAAiC,YAAY;AAC3C,UAAIG,YAAY,GAAG/C,IAAI,CAACgD,qBAAL,EAAnB;AAEA,UAAIrE,QAAQ,GAAGqB,IAAI,CAACtC,QAAL,CAAce,IAAd,CAAmB,iBAAnB,CAAf;AAEA,UAAIwE,YAAY,GAAGtE,QAAQ,CAACuE,KAAT,CAAeH,YAAf,CAAnB,CAL2C,CAO3C;AACA;;AACA,UAAIE,YAAY,IAAI,CAApB,EAAuB;AACrB;AACD;;AAED,UAAIE,SAAS,GAAGF,YAAY,GAAG,CAA/B,CAb2C,CAe3C;;AACA,UAAIF,YAAY,CAAClE,MAAb,KAAwB,CAA5B,EAA+B;AAC7BsE,QAAAA,SAAS,GAAG,CAAZ;AACD;;AAED,UAAIC,KAAK,GAAGzE,QAAQ,CAAC0E,EAAT,CAAYF,SAAZ,CAAZ;AAEAC,MAAAA,KAAK,CAACrE,OAAN,CAAc,YAAd;AAEA,UAAIuE,aAAa,GAAGtD,IAAI,CAACtC,QAAL,CAAc6F,MAAd,GAAuBC,GAA3C;AACA,UAAIC,OAAO,GAAGL,KAAK,CAACG,MAAN,GAAeC,GAA7B;AACA,UAAIE,UAAU,GAAG1D,IAAI,CAACtC,QAAL,CAAciG,SAAd,MAA6BF,OAAO,GAAGH,aAAvC,CAAjB;;AAEA,UAAIH,SAAS,KAAK,CAAlB,EAAqB;AACnBnD,QAAAA,IAAI,CAACtC,QAAL,CAAciG,SAAd,CAAwB,CAAxB;AACD,OAFD,MAEO,IAAIF,OAAO,GAAGH,aAAV,GAA0B,CAA9B,EAAiC;AACtCtD,QAAAA,IAAI,CAACtC,QAAL,CAAciG,SAAd,CAAwBD,UAAxB;AACD;AACF,KAjCD;AAmCAhB,IAAAA,SAAS,CAACE,EAAV,CAAa,cAAb,EAA6B,YAAY;AACvC,UAAIG,YAAY,GAAG/C,IAAI,CAACgD,qBAAL,EAAnB;AAEA,UAAIrE,QAAQ,GAAGqB,IAAI,CAACtC,QAAL,CAAce,IAAd,CAAmB,iBAAnB,CAAf;AAEA,UAAIwE,YAAY,GAAGtE,QAAQ,CAACuE,KAAT,CAAeH,YAAf,CAAnB;AAEA,UAAII,SAAS,GAAGF,YAAY,GAAG,CAA/B,CAPuC,CASvC;;AACA,UAAIE,SAAS,IAAIxE,QAAQ,CAACE,MAA1B,EAAkC;AAChC;AACD;;AAED,UAAIuE,KAAK,GAAGzE,QAAQ,CAAC0E,EAAT,CAAYF,SAAZ,CAAZ;AAEAC,MAAAA,KAAK,CAACrE,OAAN,CAAc,YAAd;AAEA,UAAIuE,aAAa,GAAGtD,IAAI,CAACtC,QAAL,CAAc6F,MAAd,GAAuBC,GAAvB,GAClBxD,IAAI,CAACtC,QAAL,CAAckG,WAAd,CAA0B,KAA1B,CADF;AAEA,UAAIC,UAAU,GAAGT,KAAK,CAACG,MAAN,GAAeC,GAAf,GAAqBJ,KAAK,CAACQ,WAAN,CAAkB,KAAlB,CAAtC;AACA,UAAIF,UAAU,GAAG1D,IAAI,CAACtC,QAAL,CAAciG,SAAd,KAA4BE,UAA5B,GAAyCP,aAA1D;;AAEA,UAAIH,SAAS,KAAK,CAAlB,EAAqB;AACnBnD,QAAAA,IAAI,CAACtC,QAAL,CAAciG,SAAd,CAAwB,CAAxB;AACD,OAFD,MAEO,IAAIE,UAAU,GAAGP,aAAjB,EAAgC;AACrCtD,QAAAA,IAAI,CAACtC,QAAL,CAAciG,SAAd,CAAwBD,UAAxB;AACD;AACF,KA5BD;AA8BAhB,IAAAA,SAAS,CAACE,EAAV,CAAa,eAAb,EAA8B,UAAU5E,MAAV,EAAkB;AAC9CA,MAAAA,MAAM,CAAC0C,OAAP,CAAeoD,QAAf,CAAwB,sCAAxB;AACD,KAFD;AAIApB,IAAAA,SAAS,CAACE,EAAV,CAAa,iBAAb,EAAgC,UAAU5E,MAAV,EAAkB;AAChDgC,MAAAA,IAAI,CAACjC,cAAL,CAAoBC,MAApB;AACD,KAFD;;AAIA,QAAIpB,CAAC,CAACmH,EAAF,CAAKC,UAAT,EAAqB;AACnB,WAAKtG,QAAL,CAAckF,EAAd,CAAiB,YAAjB,EAA+B,UAAUqB,CAAV,EAAa;AAC1C,YAAIT,GAAG,GAAGxD,IAAI,CAACtC,QAAL,CAAciG,SAAd,EAAV;AAEA,YAAIO,MAAM,GAAGlE,IAAI,CAACtC,QAAL,CAAcC,GAAd,CAAkB,CAAlB,EAAqBwG,YAArB,GAAoCX,GAApC,GAA0CS,CAAC,CAACG,MAAzD;AAEA,YAAIC,OAAO,GAAGJ,CAAC,CAACG,MAAF,GAAW,CAAX,IAAgBZ,GAAG,GAAGS,CAAC,CAACG,MAAR,IAAkB,CAAhD;AACA,YAAIE,UAAU,GAAGL,CAAC,CAACG,MAAF,GAAW,CAAX,IAAgBF,MAAM,IAAIlE,IAAI,CAACtC,QAAL,CAAc6G,MAAd,EAA3C;;AAEA,YAAIF,OAAJ,EAAa;AACXrE,UAAAA,IAAI,CAACtC,QAAL,CAAciG,SAAd,CAAwB,CAAxB;AAEAM,UAAAA,CAAC,CAACO,cAAF;AACAP,UAAAA,CAAC,CAACQ,eAAF;AACD,SALD,MAKO,IAAIH,UAAJ,EAAgB;AACrBtE,UAAAA,IAAI,CAACtC,QAAL,CAAciG,SAAd,CACE3D,IAAI,CAACtC,QAAL,CAAcC,GAAd,CAAkB,CAAlB,EAAqBwG,YAArB,GAAoCnE,IAAI,CAACtC,QAAL,CAAc6G,MAAd,EADtC;AAIAN,UAAAA,CAAC,CAACO,cAAF;AACAP,UAAAA,CAAC,CAACQ,eAAF;AACD;AACF,OArBD;AAsBD;;AAED,SAAK/G,QAAL,CAAckF,EAAd,CAAiB,SAAjB,EAA4B,yCAA5B,EACE,UAAU8B,GAAV,EAAe;AACf,UAAIC,KAAK,GAAG/H,CAAC,CAAC,IAAD,CAAb;AAEA,UAAIM,IAAI,GAAGL,KAAK,CAAC4D,OAAN,CAAc,IAAd,EAAoB,MAApB,CAAX;;AAEA,UAAIkE,KAAK,CAAC/G,IAAN,CAAW,eAAX,MAAgC,MAApC,EAA4C;AAC1C,YAAIoC,IAAI,CAAChD,OAAL,CAAaW,GAAb,CAAiB,UAAjB,CAAJ,EAAkC;AAChCqC,UAAAA,IAAI,CAACjB,OAAL,CAAa,UAAb,EAAyB;AACvB6F,YAAAA,aAAa,EAAEF,GADQ;AAEvBxH,YAAAA,IAAI,EAAEA;AAFiB,WAAzB;AAID,SALD,MAKO;AACL8C,UAAAA,IAAI,CAACjB,OAAL,CAAa,OAAb,EAAsB,EAAtB;AACD;;AAED;AACD;;AAEDiB,MAAAA,IAAI,CAACjB,OAAL,CAAa,QAAb,EAAuB;AACrB6F,QAAAA,aAAa,EAAEF,GADM;AAErBxH,QAAAA,IAAI,EAAEA;AAFe,OAAvB;AAID,KAvBD;AAyBA,SAAKQ,QAAL,CAAckF,EAAd,CAAiB,YAAjB,EAA+B,yCAA/B,EACE,UAAU8B,GAAV,EAAe;AACf,UAAIxH,IAAI,GAAGL,KAAK,CAAC4D,OAAN,CAAc,IAAd,EAAoB,MAApB,CAAX;AAEAT,MAAAA,IAAI,CAACgD,qBAAL,GACK6B,WADL,CACiB,sCADjB;AAGA7E,MAAAA,IAAI,CAACjB,OAAL,CAAa,eAAb,EAA8B;AAC5B7B,QAAAA,IAAI,EAAEA,IADsB;AAE5BwD,QAAAA,OAAO,EAAE9D,CAAC,CAAC,IAAD;AAFkB,OAA9B;AAID,KAXD;AAYD,GAzOD;;AA2OAE,EAAAA,OAAO,CAACU,SAAR,CAAkBwF,qBAAlB,GAA0C,YAAY;AACpD,QAAID,YAAY,GAAG,KAAKrF,QAAL,CAClBe,IADkB,CACb,uCADa,CAAnB;AAGA,WAAOsE,YAAP;AACD,GALD;;AAOAjG,EAAAA,OAAO,CAACU,SAAR,CAAkBsH,OAAlB,GAA4B,YAAY;AACtC,SAAKpH,QAAL,CAAcgB,MAAd;AACD,GAFD;;AAIA5B,EAAAA,OAAO,CAACU,SAAR,CAAkBsC,sBAAlB,GAA2C,YAAY;AACrD,QAAIiD,YAAY,GAAG,KAAKC,qBAAL,EAAnB;;AAEA,QAAID,YAAY,CAAClE,MAAb,KAAwB,CAA5B,EAA+B;AAC7B;AACD;;AAED,QAAIF,QAAQ,GAAG,KAAKjB,QAAL,CAAce,IAAd,CAAmB,iBAAnB,CAAf;AAEA,QAAIwE,YAAY,GAAGtE,QAAQ,CAACuE,KAAT,CAAeH,YAAf,CAAnB;AAEA,QAAIO,aAAa,GAAG,KAAK5F,QAAL,CAAc6F,MAAd,GAAuBC,GAA3C;AACA,QAAIC,OAAO,GAAGV,YAAY,CAACQ,MAAb,GAAsBC,GAApC;AACA,QAAIE,UAAU,GAAG,KAAKhG,QAAL,CAAciG,SAAd,MAA6BF,OAAO,GAAGH,aAAvC,CAAjB;AAEA,QAAIyB,WAAW,GAAGtB,OAAO,GAAGH,aAA5B;AACAI,IAAAA,UAAU,IAAIX,YAAY,CAACa,WAAb,CAAyB,KAAzB,IAAkC,CAAhD;;AAEA,QAAIX,YAAY,IAAI,CAApB,EAAuB;AACrB,WAAKvF,QAAL,CAAciG,SAAd,CAAwB,CAAxB;AACD,KAFD,MAEO,IAAIoB,WAAW,GAAG,KAAKrH,QAAL,CAAckG,WAAd,EAAd,IAA6CmB,WAAW,GAAG,CAA/D,EAAkE;AACvE,WAAKrH,QAAL,CAAciG,SAAd,CAAwBD,UAAxB;AACD;AACF,GAvBD;;AAyBA5G,EAAAA,OAAO,CAACU,SAAR,CAAkB0E,QAAlB,GAA6B,UAAU8C,MAAV,EAAkBtC,SAAlB,EAA6B;AACxD,QAAIR,QAAQ,GAAG,KAAKlF,OAAL,CAAaW,GAAb,CAAiB,gBAAjB,CAAf;AACA,QAAIM,YAAY,GAAG,KAAKjB,OAAL,CAAaW,GAAb,CAAiB,cAAjB,CAAnB;AAEA,QAAIsH,OAAO,GAAG/C,QAAQ,CAAC8C,MAAD,EAAStC,SAAT,CAAtB;;AAEA,QAAIuC,OAAO,IAAI,IAAf,EAAqB;AACnBvC,MAAAA,SAAS,CAACwC,KAAV,CAAgBC,OAAhB,GAA0B,MAA1B;AACD,KAFD,MAEO,IAAI,OAAOF,OAAP,KAAmB,QAAvB,EAAiC;AACtCvC,MAAAA,SAAS,CAAC0C,SAAV,GAAsBnH,YAAY,CAACgH,OAAD,CAAlC;AACD,KAFM,MAEA;AACLrI,MAAAA,CAAC,CAAC8F,SAAD,CAAD,CAAarE,MAAb,CAAoB4G,OAApB;AACD;AACF,GAbD;;AAeA,SAAOnI,OAAP;AACD,CAthBK,CAAN","sourcesContent":["define([\n  'jquery',\n  './utils'\n], function ($, Utils) {\n  function Results ($element, options, dataAdapter) {\n    this.$element = $element;\n    this.data = dataAdapter;\n    this.options = options;\n\n    Results.__super__.constructor.call(this);\n  }\n\n  Utils.Extend(Results, Utils.Observable);\n\n  Results.prototype.render = function () {\n    var $results = $(\n      '<ul class=\"select2-results__options\" role=\"listbox\"></ul>'\n    );\n\n    if (this.options.get('multiple')) {\n      $results.attr('aria-multiselectable', 'true');\n    }\n\n    this.$results = $results;\n\n    return $results;\n  };\n\n  Results.prototype.clear = function () {\n    this.$results.empty();\n  };\n\n  Results.prototype.displayMessage = function (params) {\n    var escapeMarkup = this.options.get('escapeMarkup');\n\n    this.clear();\n    this.hideLoading();\n\n    var $message = $(\n      '<li role=\"alert\" aria-live=\"assertive\"' +\n      ' class=\"select2-results__option\"></li>'\n    );\n\n    var message = this.options.get('translations').get(params.message);\n\n    $message.append(\n      escapeMarkup(\n        message(params.args)\n      )\n    );\n\n    $message[0].className += ' select2-results__message';\n\n    this.$results.append($message);\n  };\n\n  Results.prototype.hideMessages = function () {\n    this.$results.find('.select2-results__message').remove();\n  };\n\n  Results.prototype.append = function (data) {\n    this.hideLoading();\n\n    var $options = [];\n\n    if (data.results == null || data.results.length === 0) {\n      if (this.$results.children().length === 0) {\n        this.trigger('results:message', {\n          message: 'noResults'\n        });\n      }\n\n      return;\n    }\n\n    data.results = this.sort(data.results);\n\n    for (var d = 0; d < data.results.length; d++) {\n      var item = data.results[d];\n\n      var $option = this.option(item);\n\n      $options.push($option);\n    }\n\n    this.$results.append($options);\n  };\n\n  Results.prototype.position = function ($results, $dropdown) {\n    var $resultsContainer = $dropdown.find('.select2-results');\n    $resultsContainer.append($results);\n  };\n\n  Results.prototype.sort = function (data) {\n    var sorter = this.options.get('sorter');\n\n    return sorter(data);\n  };\n\n  Results.prototype.highlightFirstItem = function () {\n    var $options = this.$results\n      .find('.select2-results__option[aria-selected]');\n\n    var $selected = $options.filter('[aria-selected=true]');\n\n    // Check if there are any selected options\n    if ($selected.length > 0) {\n      // If there are selected options, highlight the first\n      $selected.first().trigger('mouseenter');\n    } else {\n      // If there are no selected options, highlight the first option\n      // in the dropdown\n      $options.first().trigger('mouseenter');\n    }\n\n    this.ensureHighlightVisible();\n  };\n\n  Results.prototype.setClasses = function () {\n    var self = this;\n\n    this.data.current(function (selected) {\n      var selectedIds = $.map(selected, function (s) {\n        return s.id.toString();\n      });\n\n      var $options = self.$results\n        .find('.select2-results__option[aria-selected]');\n\n      $options.each(function () {\n        var $option = $(this);\n\n        var item = Utils.GetData(this, 'data');\n\n        // id needs to be converted to a string when comparing\n        var id = '' + item.id;\n\n        if ((item.element != null && item.element.selected) ||\n            (item.element == null && $.inArray(id, selectedIds) > -1)) {\n          $option.attr('aria-selected', 'true');\n        } else {\n          $option.attr('aria-selected', 'false');\n        }\n      });\n\n    });\n  };\n\n  Results.prototype.showLoading = function (params) {\n    this.hideLoading();\n\n    var loadingMore = this.options.get('translations').get('searching');\n\n    var loading = {\n      disabled: true,\n      loading: true,\n      text: loadingMore(params)\n    };\n    var $loading = this.option(loading);\n    $loading.className += ' loading-results';\n\n    this.$results.prepend($loading);\n  };\n\n  Results.prototype.hideLoading = function () {\n    this.$results.find('.loading-results').remove();\n  };\n\n  Results.prototype.option = function (data) {\n    var option = document.createElement('li');\n    option.className = 'select2-results__option';\n\n    var attrs = {\n      'role': 'option',\n      'aria-selected': 'false'\n    };\n\n    var matches = window.Element.prototype.matches ||\n      window.Element.prototype.msMatchesSelector ||\n      window.Element.prototype.webkitMatchesSelector;\n\n    if ((data.element != null && matches.call(data.element, ':disabled')) ||\n        (data.element == null && data.disabled)) {\n      delete attrs['aria-selected'];\n      attrs['aria-disabled'] = 'true';\n    }\n\n    if (data.id == null) {\n      delete attrs['aria-selected'];\n    }\n\n    if (data._resultId != null) {\n      option.id = data._resultId;\n    }\n\n    if (data.title) {\n      option.title = data.title;\n    }\n\n    if (data.children) {\n      attrs.role = 'group';\n      attrs['aria-label'] = data.text;\n      delete attrs['aria-selected'];\n    }\n\n    for (var attr in attrs) {\n      var val = attrs[attr];\n\n      option.setAttribute(attr, val);\n    }\n\n    if (data.children) {\n      var $option = $(option);\n\n      var label = document.createElement('strong');\n      label.className = 'select2-results__group';\n\n      var $label = $(label);\n      this.template(data, label);\n\n      var $children = [];\n\n      for (var c = 0; c < data.children.length; c++) {\n        var child = data.children[c];\n\n        var $child = this.option(child);\n\n        $children.push($child);\n      }\n\n      var $childrenContainer = $('<ul></ul>', {\n        'class': 'select2-results__options select2-results__options--nested'\n      });\n\n      $childrenContainer.append($children);\n\n      $option.append(label);\n      $option.append($childrenContainer);\n    } else {\n      this.template(data, option);\n    }\n\n    Utils.StoreData(option, 'data', data);\n\n    return option;\n  };\n\n  Results.prototype.bind = function (container, $container) {\n    var self = this;\n\n    var id = container.id + '-results';\n\n    this.$results.attr('id', id);\n\n    container.on('results:all', function (params) {\n      self.clear();\n      self.append(params.data);\n\n      if (container.isOpen()) {\n        self.setClasses();\n        self.highlightFirstItem();\n      }\n    });\n\n    container.on('results:append', function (params) {\n      self.append(params.data);\n\n      if (container.isOpen()) {\n        self.setClasses();\n      }\n    });\n\n    container.on('query', function (params) {\n      self.hideMessages();\n      self.showLoading(params);\n    });\n\n    container.on('select', function () {\n      if (!container.isOpen()) {\n        return;\n      }\n\n      self.setClasses();\n\n      if (self.options.get('scrollAfterSelect')) {\n        self.highlightFirstItem();\n      }\n    });\n\n    container.on('unselect', function () {\n      if (!container.isOpen()) {\n        return;\n      }\n\n      self.setClasses();\n\n      if (self.options.get('scrollAfterSelect')) {\n        self.highlightFirstItem();\n      }\n    });\n\n    container.on('open', function () {\n      // When the dropdown is open, aria-expended=\"true\"\n      self.$results.attr('aria-expanded', 'true');\n      self.$results.attr('aria-hidden', 'false');\n\n      self.setClasses();\n      self.ensureHighlightVisible();\n    });\n\n    container.on('close', function () {\n      // When the dropdown is closed, aria-expended=\"false\"\n      self.$results.attr('aria-expanded', 'false');\n      self.$results.attr('aria-hidden', 'true');\n      self.$results.removeAttr('aria-activedescendant');\n    });\n\n    container.on('results:toggle', function () {\n      var $highlighted = self.getHighlightedResults();\n\n      if ($highlighted.length === 0) {\n        return;\n      }\n\n      $highlighted.trigger('mouseup');\n    });\n\n    container.on('results:select', function () {\n      var $highlighted = self.getHighlightedResults();\n\n      if ($highlighted.length === 0) {\n        return;\n      }\n\n      var data = Utils.GetData($highlighted[0], 'data');\n\n      if ($highlighted.attr('aria-selected') == 'true') {\n        self.trigger('close', {});\n      } else {\n        self.trigger('select', {\n          data: data\n        });\n      }\n    });\n\n    container.on('results:previous', function () {\n      var $highlighted = self.getHighlightedResults();\n\n      var $options = self.$results.find('[aria-selected]');\n\n      var currentIndex = $options.index($highlighted);\n\n      // If we are already at the top, don't move further\n      // If no options, currentIndex will be -1\n      if (currentIndex <= 0) {\n        return;\n      }\n\n      var nextIndex = currentIndex - 1;\n\n      // If none are highlighted, highlight the first\n      if ($highlighted.length === 0) {\n        nextIndex = 0;\n      }\n\n      var $next = $options.eq(nextIndex);\n\n      $next.trigger('mouseenter');\n\n      var currentOffset = self.$results.offset().top;\n      var nextTop = $next.offset().top;\n      var nextOffset = self.$results.scrollTop() + (nextTop - currentOffset);\n\n      if (nextIndex === 0) {\n        self.$results.scrollTop(0);\n      } else if (nextTop - currentOffset < 0) {\n        self.$results.scrollTop(nextOffset);\n      }\n    });\n\n    container.on('results:next', function () {\n      var $highlighted = self.getHighlightedResults();\n\n      var $options = self.$results.find('[aria-selected]');\n\n      var currentIndex = $options.index($highlighted);\n\n      var nextIndex = currentIndex + 1;\n\n      // If we are at the last option, stay there\n      if (nextIndex >= $options.length) {\n        return;\n      }\n\n      var $next = $options.eq(nextIndex);\n\n      $next.trigger('mouseenter');\n\n      var currentOffset = self.$results.offset().top +\n        self.$results.outerHeight(false);\n      var nextBottom = $next.offset().top + $next.outerHeight(false);\n      var nextOffset = self.$results.scrollTop() + nextBottom - currentOffset;\n\n      if (nextIndex === 0) {\n        self.$results.scrollTop(0);\n      } else if (nextBottom > currentOffset) {\n        self.$results.scrollTop(nextOffset);\n      }\n    });\n\n    container.on('results:focus', function (params) {\n      params.element.addClass('select2-results__option--highlighted');\n    });\n\n    container.on('results:message', function (params) {\n      self.displayMessage(params);\n    });\n\n    if ($.fn.mousewheel) {\n      this.$results.on('mousewheel', function (e) {\n        var top = self.$results.scrollTop();\n\n        var bottom = self.$results.get(0).scrollHeight - top + e.deltaY;\n\n        var isAtTop = e.deltaY > 0 && top - e.deltaY <= 0;\n        var isAtBottom = e.deltaY < 0 && bottom <= self.$results.height();\n\n        if (isAtTop) {\n          self.$results.scrollTop(0);\n\n          e.preventDefault();\n          e.stopPropagation();\n        } else if (isAtBottom) {\n          self.$results.scrollTop(\n            self.$results.get(0).scrollHeight - self.$results.height()\n          );\n\n          e.preventDefault();\n          e.stopPropagation();\n        }\n      });\n    }\n\n    this.$results.on('mouseup', '.select2-results__option[aria-selected]',\n      function (evt) {\n      var $this = $(this);\n\n      var data = Utils.GetData(this, 'data');\n\n      if ($this.attr('aria-selected') === 'true') {\n        if (self.options.get('multiple')) {\n          self.trigger('unselect', {\n            originalEvent: evt,\n            data: data\n          });\n        } else {\n          self.trigger('close', {});\n        }\n\n        return;\n      }\n\n      self.trigger('select', {\n        originalEvent: evt,\n        data: data\n      });\n    });\n\n    this.$results.on('mouseenter', '.select2-results__option[aria-selected]',\n      function (evt) {\n      var data = Utils.GetData(this, 'data');\n\n      self.getHighlightedResults()\n          .removeClass('select2-results__option--highlighted');\n\n      self.trigger('results:focus', {\n        data: data,\n        element: $(this)\n      });\n    });\n  };\n\n  Results.prototype.getHighlightedResults = function () {\n    var $highlighted = this.$results\n    .find('.select2-results__option--highlighted');\n\n    return $highlighted;\n  };\n\n  Results.prototype.destroy = function () {\n    this.$results.remove();\n  };\n\n  Results.prototype.ensureHighlightVisible = function () {\n    var $highlighted = this.getHighlightedResults();\n\n    if ($highlighted.length === 0) {\n      return;\n    }\n\n    var $options = this.$results.find('[aria-selected]');\n\n    var currentIndex = $options.index($highlighted);\n\n    var currentOffset = this.$results.offset().top;\n    var nextTop = $highlighted.offset().top;\n    var nextOffset = this.$results.scrollTop() + (nextTop - currentOffset);\n\n    var offsetDelta = nextTop - currentOffset;\n    nextOffset -= $highlighted.outerHeight(false) * 2;\n\n    if (currentIndex <= 2) {\n      this.$results.scrollTop(0);\n    } else if (offsetDelta > this.$results.outerHeight() || offsetDelta < 0) {\n      this.$results.scrollTop(nextOffset);\n    }\n  };\n\n  Results.prototype.template = function (result, container) {\n    var template = this.options.get('templateResult');\n    var escapeMarkup = this.options.get('escapeMarkup');\n\n    var content = template(result, container);\n\n    if (content == null) {\n      container.style.display = 'none';\n    } else if (typeof content === 'string') {\n      container.innerHTML = escapeMarkup(content);\n    } else {\n      $(container).append(content);\n    }\n  };\n\n  return Results;\n});\n"]},"metadata":{},"sourceType":"module"}