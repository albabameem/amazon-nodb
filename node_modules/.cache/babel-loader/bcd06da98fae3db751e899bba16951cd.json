{"ast":null,"code":"import extend from 'extend';\nimport Emitter from '../core/emitter';\nimport BaseTheme, { BaseTooltip } from './base';\nimport { Range } from '../core/selection';\nimport icons from '../ui/icons';\nconst TOOLBAR_CONFIG = [['bold', 'italic', 'link'], [{\n  header: 1\n}, {\n  header: 2\n}, 'blockquote']];\n\nclass BubbleTheme extends BaseTheme {\n  constructor(quill, options) {\n    if (options.modules.toolbar != null && options.modules.toolbar.container == null) {\n      options.modules.toolbar.container = TOOLBAR_CONFIG;\n    }\n\n    super(quill, options);\n    this.quill.container.classList.add('ql-bubble');\n  }\n\n  extendToolbar(toolbar) {\n    this.tooltip = new BubbleTooltip(this.quill, this.options.bounds);\n    this.tooltip.root.appendChild(toolbar.container);\n    this.buildButtons([].slice.call(toolbar.container.querySelectorAll('button')), icons);\n    this.buildPickers([].slice.call(toolbar.container.querySelectorAll('select')), icons);\n  }\n\n}\n\nBubbleTheme.DEFAULTS = extend(true, {}, BaseTheme.DEFAULTS, {\n  modules: {\n    toolbar: {\n      handlers: {\n        link: function (value) {\n          if (!value) {\n            this.quill.format('link', false);\n          } else {\n            this.quill.theme.tooltip.edit();\n          }\n        }\n      }\n    }\n  }\n});\n\nclass BubbleTooltip extends BaseTooltip {\n  constructor(quill, bounds) {\n    super(quill, bounds);\n    this.quill.on(Emitter.events.EDITOR_CHANGE, (type, range, oldRange, source) => {\n      if (type !== Emitter.events.SELECTION_CHANGE) return;\n\n      if (range != null && range.length > 0 && source === Emitter.sources.USER) {\n        this.show(); // Lock our width so we will expand beyond our offsetParent boundaries\n\n        this.root.style.left = '0px';\n        this.root.style.width = '';\n        this.root.style.width = this.root.offsetWidth + 'px';\n        let lines = this.quill.getLines(range.index, range.length);\n\n        if (lines.length === 1) {\n          this.position(this.quill.getBounds(range));\n        } else {\n          let lastLine = lines[lines.length - 1];\n          let index = this.quill.getIndex(lastLine);\n          let length = Math.min(lastLine.length() - 1, range.index + range.length - index);\n          let bounds = this.quill.getBounds(new Range(index, length));\n          this.position(bounds);\n        }\n      } else if (document.activeElement !== this.textbox && this.quill.hasFocus()) {\n        this.hide();\n      }\n    });\n  }\n\n  listen() {\n    super.listen();\n    this.root.querySelector('.ql-close').addEventListener('click', () => {\n      this.root.classList.remove('ql-editing');\n    });\n    this.quill.on(Emitter.events.SCROLL_OPTIMIZE, () => {\n      // Let selection be restored by toolbar handlers before repositioning\n      setTimeout(() => {\n        if (this.root.classList.contains('ql-hidden')) return;\n        let range = this.quill.getSelection();\n\n        if (range != null) {\n          this.position(this.quill.getBounds(range));\n        }\n      }, 1);\n    });\n  }\n\n  cancel() {\n    this.show();\n  }\n\n  position(reference) {\n    let shift = super.position(reference);\n    let arrow = this.root.querySelector('.ql-tooltip-arrow');\n    arrow.style.marginLeft = '';\n    if (shift === 0) return shift;\n    arrow.style.marginLeft = -1 * shift - arrow.offsetWidth / 2 + 'px';\n  }\n\n}\n\nBubbleTooltip.TEMPLATE = ['<span class=\"ql-tooltip-arrow\"></span>', '<div class=\"ql-tooltip-editor\">', '<input type=\"text\" data-formula=\"e=mc^2\" data-link=\"https://quilljs.com\" data-video=\"Embed URL\">', '<a class=\"ql-close\"></a>', '</div>'].join('');\nexport { BubbleTooltip, BubbleTheme as default };","map":{"version":3,"sources":["/Users/albab/bookapro/amazon/src/assets/vendor/quill/themes/bubble.js"],"names":["extend","Emitter","BaseTheme","BaseTooltip","Range","icons","TOOLBAR_CONFIG","header","BubbleTheme","constructor","quill","options","modules","toolbar","container","classList","add","extendToolbar","tooltip","BubbleTooltip","bounds","root","appendChild","buildButtons","slice","call","querySelectorAll","buildPickers","DEFAULTS","handlers","link","value","format","theme","edit","on","events","EDITOR_CHANGE","type","range","oldRange","source","SELECTION_CHANGE","length","sources","USER","show","style","left","width","offsetWidth","lines","getLines","index","position","getBounds","lastLine","getIndex","Math","min","document","activeElement","textbox","hasFocus","hide","listen","querySelector","addEventListener","remove","SCROLL_OPTIMIZE","setTimeout","contains","getSelection","cancel","reference","shift","arrow","marginLeft","TEMPLATE","join","default"],"mappings":"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","sourcesContent":["import extend from 'extend';\nimport Emitter from '../core/emitter';\nimport BaseTheme, { BaseTooltip } from './base';\nimport { Range } from '../core/selection';\nimport icons from '../ui/icons';\n\n\nconst TOOLBAR_CONFIG = [\n  ['bold', 'italic', 'link'],\n  [{ header: 1 }, { header: 2 }, 'blockquote']\n];\n\nclass BubbleTheme extends BaseTheme {\n  constructor(quill, options) {\n    if (options.modules.toolbar != null && options.modules.toolbar.container == null) {\n      options.modules.toolbar.container = TOOLBAR_CONFIG;\n    }\n    super(quill, options);\n    this.quill.container.classList.add('ql-bubble');\n  }\n\n  extendToolbar(toolbar) {\n    this.tooltip = new BubbleTooltip(this.quill, this.options.bounds);\n    this.tooltip.root.appendChild(toolbar.container);\n    this.buildButtons([].slice.call(toolbar.container.querySelectorAll('button')), icons);\n    this.buildPickers([].slice.call(toolbar.container.querySelectorAll('select')), icons);\n  }\n}\nBubbleTheme.DEFAULTS = extend(true, {}, BaseTheme.DEFAULTS, {\n  modules: {\n    toolbar: {\n      handlers: {\n        link: function(value) {\n          if (!value) {\n            this.quill.format('link', false);\n          } else {\n            this.quill.theme.tooltip.edit();\n          }\n        }\n      }\n    }\n  }\n});\n\n\nclass BubbleTooltip extends BaseTooltip {\n  constructor(quill, bounds) {\n    super(quill, bounds);\n    this.quill.on(Emitter.events.EDITOR_CHANGE, (type, range, oldRange, source) => {\n      if (type !== Emitter.events.SELECTION_CHANGE) return;\n      if (range != null && range.length > 0 && source === Emitter.sources.USER) {\n        this.show();\n        // Lock our width so we will expand beyond our offsetParent boundaries\n        this.root.style.left = '0px';\n        this.root.style.width = '';\n        this.root.style.width = this.root.offsetWidth + 'px';\n        let lines = this.quill.getLines(range.index, range.length);\n        if (lines.length === 1) {\n          this.position(this.quill.getBounds(range));\n        } else {\n          let lastLine = lines[lines.length - 1];\n          let index = this.quill.getIndex(lastLine);\n          let length = Math.min(lastLine.length() - 1, range.index + range.length - index);\n          let bounds = this.quill.getBounds(new Range(index, length));\n          this.position(bounds);\n        }\n      } else if (document.activeElement !== this.textbox && this.quill.hasFocus()) {\n        this.hide();\n      }\n    });\n  }\n\n  listen() {\n    super.listen();\n    this.root.querySelector('.ql-close').addEventListener('click', () => {\n      this.root.classList.remove('ql-editing');\n    });\n    this.quill.on(Emitter.events.SCROLL_OPTIMIZE, () => {\n      // Let selection be restored by toolbar handlers before repositioning\n      setTimeout(() => {\n        if (this.root.classList.contains('ql-hidden')) return;\n        let range = this.quill.getSelection();\n        if (range != null) {\n          this.position(this.quill.getBounds(range));\n        }\n      }, 1);\n    });\n  }\n\n  cancel() {\n    this.show();\n  }\n\n  position(reference) {\n    let shift = super.position(reference);\n    let arrow = this.root.querySelector('.ql-tooltip-arrow');\n    arrow.style.marginLeft = '';\n    if (shift === 0) return shift;\n    arrow.style.marginLeft = (-1*shift - arrow.offsetWidth/2) + 'px';\n  }\n}\nBubbleTooltip.TEMPLATE = [\n  '<span class=\"ql-tooltip-arrow\"></span>',\n  '<div class=\"ql-tooltip-editor\">',\n    '<input type=\"text\" data-formula=\"e=mc^2\" data-link=\"https://quilljs.com\" data-video=\"Embed URL\">',\n    '<a class=\"ql-close\"></a>',\n  '</div>'\n].join('');\n\n\nexport { BubbleTooltip, BubbleTheme as default };\n"]},"metadata":{},"sourceType":"module"}