{"ast":null,"code":"define(['jquery', '../utils', '../keys'], function ($, Utils, KEYS) {\n  function BaseSelection($element, options) {\n    this.$element = $element;\n    this.options = options;\n\n    BaseSelection.__super__.constructor.call(this);\n  }\n\n  Utils.Extend(BaseSelection, Utils.Observable);\n\n  BaseSelection.prototype.render = function () {\n    var $selection = $('<span class=\"select2-selection\" role=\"combobox\" ' + ' aria-haspopup=\"true\" aria-expanded=\"false\">' + '</span>');\n    this._tabindex = 0;\n\n    if (Utils.GetData(this.$element[0], 'old-tabindex') != null) {\n      this._tabindex = Utils.GetData(this.$element[0], 'old-tabindex');\n    } else if (this.$element.attr('tabindex') != null) {\n      this._tabindex = this.$element.attr('tabindex');\n    }\n\n    $selection.attr('title', this.$element.attr('title'));\n    $selection.attr('tabindex', this._tabindex);\n    $selection.attr('aria-disabled', 'false');\n    this.$selection = $selection;\n    return $selection;\n  };\n\n  BaseSelection.prototype.bind = function (container, $container) {\n    var self = this;\n    var resultsId = container.id + '-results';\n    this.container = container;\n    this.$selection.on('focus', function (evt) {\n      self.trigger('focus', evt);\n    });\n    this.$selection.on('blur', function (evt) {\n      self._handleBlur(evt);\n    });\n    this.$selection.on('keydown', function (evt) {\n      self.trigger('keypress', evt);\n\n      if (evt.which === KEYS.SPACE) {\n        evt.preventDefault();\n      }\n    });\n    container.on('results:focus', function (params) {\n      self.$selection.attr('aria-activedescendant', params.data._resultId);\n    });\n    container.on('selection:update', function (params) {\n      self.update(params.data);\n    });\n    container.on('open', function () {\n      // When the dropdown is open, aria-expanded=\"true\"\n      self.$selection.attr('aria-expanded', 'true');\n      self.$selection.attr('aria-owns', resultsId);\n\n      self._attachCloseHandler(container);\n    });\n    container.on('close', function () {\n      // When the dropdown is closed, aria-expanded=\"false\"\n      self.$selection.attr('aria-expanded', 'false');\n      self.$selection.removeAttr('aria-activedescendant');\n      self.$selection.removeAttr('aria-owns');\n      self.$selection.trigger('focus');\n\n      self._detachCloseHandler(container);\n    });\n    container.on('enable', function () {\n      self.$selection.attr('tabindex', self._tabindex);\n      self.$selection.attr('aria-disabled', 'false');\n    });\n    container.on('disable', function () {\n      self.$selection.attr('tabindex', '-1');\n      self.$selection.attr('aria-disabled', 'true');\n    });\n  };\n\n  BaseSelection.prototype._handleBlur = function (evt) {\n    var self = this; // This needs to be delayed as the active element is the body when the tab\n    // key is pressed, possibly along with others.\n\n    window.setTimeout(function () {\n      // Don't trigger `blur` if the focus is still in the selection\n      if (document.activeElement == self.$selection[0] || $.contains(self.$selection[0], document.activeElement)) {\n        return;\n      }\n\n      self.trigger('blur', evt);\n    }, 1);\n  };\n\n  BaseSelection.prototype._attachCloseHandler = function (container) {\n    $(document.body).on('mousedown.select2.' + container.id, function (e) {\n      var $target = $(e.target);\n      var $select = $target.closest('.select2');\n      var $all = $('.select2.select2-container--open');\n      $all.each(function () {\n        if (this == $select[0]) {\n          return;\n        }\n\n        var $element = Utils.GetData(this, 'element');\n        $element.select2('close');\n      });\n    });\n  };\n\n  BaseSelection.prototype._detachCloseHandler = function (container) {\n    $(document.body).off('mousedown.select2.' + container.id);\n  };\n\n  BaseSelection.prototype.position = function ($selection, $container) {\n    var $selectionContainer = $container.find('.selection');\n    $selectionContainer.append($selection);\n  };\n\n  BaseSelection.prototype.destroy = function () {\n    this._detachCloseHandler(this.container);\n  };\n\n  BaseSelection.prototype.update = function (data) {\n    throw new Error('The `update` method must be defined in child classes.');\n  };\n  /**\n   * Helper method to abstract the \"enabled\" (not \"disabled\") state of this\n   * object.\n   *\n   * @return {true} if the instance is not disabled.\n   * @return {false} if the instance is disabled.\n   */\n\n\n  BaseSelection.prototype.isEnabled = function () {\n    return !this.isDisabled();\n  };\n  /**\n   * Helper method to abstract the \"disabled\" state of this object.\n   *\n   * @return {true} if the disabled option is true.\n   * @return {false} if the disabled option is false.\n   */\n\n\n  BaseSelection.prototype.isDisabled = function () {\n    return this.options.get('disabled');\n  };\n\n  return BaseSelection;\n});","map":{"version":3,"sources":["/Users/albab/bookapro/amazon/src/assets/vendor/select2/src/js/select2/selection/base.js"],"names":["define","$","Utils","KEYS","BaseSelection","$element","options","__super__","constructor","call","Extend","Observable","prototype","render","$selection","_tabindex","GetData","attr","bind","container","$container","self","resultsId","id","on","evt","trigger","_handleBlur","which","SPACE","preventDefault","params","data","_resultId","update","_attachCloseHandler","removeAttr","_detachCloseHandler","window","setTimeout","document","activeElement","contains","body","e","$target","target","$select","closest","$all","each","select2","off","position","$selectionContainer","find","append","destroy","Error","isEnabled","isDisabled","get"],"mappings":"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","sourcesContent":["define([\n  'jquery',\n  '../utils',\n  '../keys'\n], function ($, Utils, KEYS) {\n  function BaseSelection ($element, options) {\n    this.$element = $element;\n    this.options = options;\n\n    BaseSelection.__super__.constructor.call(this);\n  }\n\n  Utils.Extend(BaseSelection, Utils.Observable);\n\n  BaseSelection.prototype.render = function () {\n    var $selection = $(\n      '<span class=\"select2-selection\" role=\"combobox\" ' +\n      ' aria-haspopup=\"true\" aria-expanded=\"false\">' +\n      '</span>'\n    );\n\n    this._tabindex = 0;\n\n    if (Utils.GetData(this.$element[0], 'old-tabindex') != null) {\n      this._tabindex = Utils.GetData(this.$element[0], 'old-tabindex');\n    } else if (this.$element.attr('tabindex') != null) {\n      this._tabindex = this.$element.attr('tabindex');\n    }\n\n    $selection.attr('title', this.$element.attr('title'));\n    $selection.attr('tabindex', this._tabindex);\n    $selection.attr('aria-disabled', 'false');\n\n    this.$selection = $selection;\n\n    return $selection;\n  };\n\n  BaseSelection.prototype.bind = function (container, $container) {\n    var self = this;\n\n    var resultsId = container.id + '-results';\n\n    this.container = container;\n\n    this.$selection.on('focus', function (evt) {\n      self.trigger('focus', evt);\n    });\n\n    this.$selection.on('blur', function (evt) {\n      self._handleBlur(evt);\n    });\n\n    this.$selection.on('keydown', function (evt) {\n      self.trigger('keypress', evt);\n\n      if (evt.which === KEYS.SPACE) {\n        evt.preventDefault();\n      }\n    });\n\n    container.on('results:focus', function (params) {\n      self.$selection.attr('aria-activedescendant', params.data._resultId);\n    });\n\n    container.on('selection:update', function (params) {\n      self.update(params.data);\n    });\n\n    container.on('open', function () {\n      // When the dropdown is open, aria-expanded=\"true\"\n      self.$selection.attr('aria-expanded', 'true');\n      self.$selection.attr('aria-owns', resultsId);\n\n      self._attachCloseHandler(container);\n    });\n\n    container.on('close', function () {\n      // When the dropdown is closed, aria-expanded=\"false\"\n      self.$selection.attr('aria-expanded', 'false');\n      self.$selection.removeAttr('aria-activedescendant');\n      self.$selection.removeAttr('aria-owns');\n\n      self.$selection.trigger('focus');\n\n      self._detachCloseHandler(container);\n    });\n\n    container.on('enable', function () {\n      self.$selection.attr('tabindex', self._tabindex);\n      self.$selection.attr('aria-disabled', 'false');\n    });\n\n    container.on('disable', function () {\n      self.$selection.attr('tabindex', '-1');\n      self.$selection.attr('aria-disabled', 'true');\n    });\n  };\n\n  BaseSelection.prototype._handleBlur = function (evt) {\n    var self = this;\n\n    // This needs to be delayed as the active element is the body when the tab\n    // key is pressed, possibly along with others.\n    window.setTimeout(function () {\n      // Don't trigger `blur` if the focus is still in the selection\n      if (\n        (document.activeElement == self.$selection[0]) ||\n        ($.contains(self.$selection[0], document.activeElement))\n      ) {\n        return;\n      }\n\n      self.trigger('blur', evt);\n    }, 1);\n  };\n\n  BaseSelection.prototype._attachCloseHandler = function (container) {\n\n    $(document.body).on('mousedown.select2.' + container.id, function (e) {\n      var $target = $(e.target);\n\n      var $select = $target.closest('.select2');\n\n      var $all = $('.select2.select2-container--open');\n\n      $all.each(function () {\n        if (this == $select[0]) {\n          return;\n        }\n\n        var $element = Utils.GetData(this, 'element');\n\n        $element.select2('close');\n      });\n    });\n  };\n\n  BaseSelection.prototype._detachCloseHandler = function (container) {\n    $(document.body).off('mousedown.select2.' + container.id);\n  };\n\n  BaseSelection.prototype.position = function ($selection, $container) {\n    var $selectionContainer = $container.find('.selection');\n    $selectionContainer.append($selection);\n  };\n\n  BaseSelection.prototype.destroy = function () {\n    this._detachCloseHandler(this.container);\n  };\n\n  BaseSelection.prototype.update = function (data) {\n    throw new Error('The `update` method must be defined in child classes.');\n  };\n\n  /**\n   * Helper method to abstract the \"enabled\" (not \"disabled\") state of this\n   * object.\n   *\n   * @return {true} if the instance is not disabled.\n   * @return {false} if the instance is disabled.\n   */\n  BaseSelection.prototype.isEnabled = function () {\n    return !this.isDisabled();\n  };\n\n  /**\n   * Helper method to abstract the \"disabled\" state of this object.\n   *\n   * @return {true} if the disabled option is true.\n   * @return {false} if the disabled option is false.\n   */\n  BaseSelection.prototype.isDisabled = function () {\n    return this.options.get('disabled');\n  };\n\n  return BaseSelection;\n});\n"]},"metadata":{},"sourceType":"module"}