{"ast":null,"code":"define(['jquery', '../utils'], function ($, Utils) {\n  function AttachBody(decorated, $element, options) {\n    this.$dropdownParent = $(options.get('dropdownParent') || document.body);\n    decorated.call(this, $element, options);\n  }\n\n  AttachBody.prototype.bind = function (decorated, container, $container) {\n    var self = this;\n    decorated.call(this, container, $container);\n    container.on('open', function () {\n      self._showDropdown();\n\n      self._attachPositioningHandler(container); // Must bind after the results handlers to ensure correct sizing\n\n\n      self._bindContainerResultHandlers(container);\n    });\n    container.on('close', function () {\n      self._hideDropdown();\n\n      self._detachPositioningHandler(container);\n    });\n    this.$dropdownContainer.on('mousedown', function (evt) {\n      evt.stopPropagation();\n    });\n  };\n\n  AttachBody.prototype.destroy = function (decorated) {\n    decorated.call(this);\n    this.$dropdownContainer.remove();\n  };\n\n  AttachBody.prototype.position = function (decorated, $dropdown, $container) {\n    // Clone all of the container classes\n    $dropdown.attr('class', $container.attr('class'));\n    $dropdown.removeClass('select2');\n    $dropdown.addClass('select2-container--open');\n    $dropdown.css({\n      position: 'absolute',\n      top: -999999\n    });\n    this.$container = $container;\n  };\n\n  AttachBody.prototype.render = function (decorated) {\n    var $container = $('<span></span>');\n    var $dropdown = decorated.call(this);\n    $container.append($dropdown);\n    this.$dropdownContainer = $container;\n    return $container;\n  };\n\n  AttachBody.prototype._hideDropdown = function (decorated) {\n    this.$dropdownContainer.detach();\n  };\n\n  AttachBody.prototype._bindContainerResultHandlers = function (decorated, container) {\n    // These should only be bound once\n    if (this._containerResultsHandlersBound) {\n      return;\n    }\n\n    var self = this;\n    container.on('results:all', function () {\n      self._positionDropdown();\n\n      self._resizeDropdown();\n    });\n    container.on('results:append', function () {\n      self._positionDropdown();\n\n      self._resizeDropdown();\n    });\n    container.on('results:message', function () {\n      self._positionDropdown();\n\n      self._resizeDropdown();\n    });\n    container.on('select', function () {\n      self._positionDropdown();\n\n      self._resizeDropdown();\n    });\n    container.on('unselect', function () {\n      self._positionDropdown();\n\n      self._resizeDropdown();\n    });\n    this._containerResultsHandlersBound = true;\n  };\n\n  AttachBody.prototype._attachPositioningHandler = function (decorated, container) {\n    var self = this;\n    var scrollEvent = 'scroll.select2.' + container.id;\n    var resizeEvent = 'resize.select2.' + container.id;\n    var orientationEvent = 'orientationchange.select2.' + container.id;\n    var $watchers = this.$container.parents().filter(Utils.hasScroll);\n    $watchers.each(function () {\n      Utils.StoreData(this, 'select2-scroll-position', {\n        x: $(this).scrollLeft(),\n        y: $(this).scrollTop()\n      });\n    });\n    $watchers.on(scrollEvent, function (ev) {\n      var position = Utils.GetData(this, 'select2-scroll-position');\n      $(this).scrollTop(position.y);\n    });\n    $(window).on(scrollEvent + ' ' + resizeEvent + ' ' + orientationEvent, function (e) {\n      self._positionDropdown();\n\n      self._resizeDropdown();\n    });\n  };\n\n  AttachBody.prototype._detachPositioningHandler = function (decorated, container) {\n    var scrollEvent = 'scroll.select2.' + container.id;\n    var resizeEvent = 'resize.select2.' + container.id;\n    var orientationEvent = 'orientationchange.select2.' + container.id;\n    var $watchers = this.$container.parents().filter(Utils.hasScroll);\n    $watchers.off(scrollEvent);\n    $(window).off(scrollEvent + ' ' + resizeEvent + ' ' + orientationEvent);\n  };\n\n  AttachBody.prototype._positionDropdown = function () {\n    var $window = $(window);\n    var isCurrentlyAbove = this.$dropdown.hasClass('select2-dropdown--above');\n    var isCurrentlyBelow = this.$dropdown.hasClass('select2-dropdown--below');\n    var newDirection = null;\n    var offset = this.$container.offset();\n    offset.bottom = offset.top + this.$container.outerHeight(false);\n    var container = {\n      height: this.$container.outerHeight(false)\n    };\n    container.top = offset.top;\n    container.bottom = offset.top + container.height;\n    var dropdown = {\n      height: this.$dropdown.outerHeight(false)\n    };\n    var viewport = {\n      top: $window.scrollTop(),\n      bottom: $window.scrollTop() + $window.height()\n    };\n    var enoughRoomAbove = viewport.top < offset.top - dropdown.height;\n    var enoughRoomBelow = viewport.bottom > offset.bottom + dropdown.height;\n    var css = {\n      left: offset.left,\n      top: container.bottom\n    }; // Determine what the parent element is to use for calculating the offset\n\n    var $offsetParent = this.$dropdownParent; // For statically positioned elements, we need to get the element\n    // that is determining the offset\n\n    if ($offsetParent.css('position') === 'static') {\n      $offsetParent = $offsetParent.offsetParent();\n    }\n\n    var parentOffset = {\n      top: 0,\n      left: 0\n    };\n\n    if ($.contains(document.body, $offsetParent[0]) || $offsetParent[0].isConnected) {\n      parentOffset = $offsetParent.offset();\n    }\n\n    css.top -= parentOffset.top;\n    css.left -= parentOffset.left;\n\n    if (!isCurrentlyAbove && !isCurrentlyBelow) {\n      newDirection = 'below';\n    }\n\n    if (!enoughRoomBelow && enoughRoomAbove && !isCurrentlyAbove) {\n      newDirection = 'above';\n    } else if (!enoughRoomAbove && enoughRoomBelow && isCurrentlyAbove) {\n      newDirection = 'below';\n    }\n\n    if (newDirection == 'above' || isCurrentlyAbove && newDirection !== 'below') {\n      css.top = container.top - parentOffset.top - dropdown.height;\n    }\n\n    if (newDirection != null) {\n      this.$dropdown.removeClass('select2-dropdown--below select2-dropdown--above').addClass('select2-dropdown--' + newDirection);\n      this.$container.removeClass('select2-container--below select2-container--above').addClass('select2-container--' + newDirection);\n    }\n\n    this.$dropdownContainer.css(css);\n  };\n\n  AttachBody.prototype._resizeDropdown = function () {\n    var css = {\n      width: this.$container.outerWidth(false) + 'px'\n    };\n\n    if (this.options.get('dropdownAutoWidth')) {\n      css.minWidth = css.width;\n      css.position = 'relative';\n      css.width = 'auto';\n    }\n\n    this.$dropdown.css(css);\n  };\n\n  AttachBody.prototype._showDropdown = function (decorated) {\n    this.$dropdownContainer.appendTo(this.$dropdownParent);\n\n    this._positionDropdown();\n\n    this._resizeDropdown();\n  };\n\n  return AttachBody;\n});","map":{"version":3,"sources":["/Users/albab/bookapro/amazon/src/assets/vendor/select2/src/js/select2/dropdown/attachBody.js"],"names":["define","$","Utils","AttachBody","decorated","$element","options","$dropdownParent","get","document","body","call","prototype","bind","container","$container","self","on","_showDropdown","_attachPositioningHandler","_bindContainerResultHandlers","_hideDropdown","_detachPositioningHandler","$dropdownContainer","evt","stopPropagation","destroy","remove","position","$dropdown","attr","removeClass","addClass","css","top","render","append","detach","_containerResultsHandlersBound","_positionDropdown","_resizeDropdown","scrollEvent","id","resizeEvent","orientationEvent","$watchers","parents","filter","hasScroll","each","StoreData","x","scrollLeft","y","scrollTop","ev","GetData","window","e","off","$window","isCurrentlyAbove","hasClass","isCurrentlyBelow","newDirection","offset","bottom","outerHeight","height","dropdown","viewport","enoughRoomAbove","enoughRoomBelow","left","$offsetParent","offsetParent","parentOffset","contains","isConnected","width","outerWidth","minWidth","appendTo"],"mappings":"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","sourcesContent":["define([\n  'jquery',\n  '../utils'\n], function ($, Utils) {\n  function AttachBody (decorated, $element, options) {\n    this.$dropdownParent = $(options.get('dropdownParent') || document.body);\n\n    decorated.call(this, $element, options);\n  }\n\n  AttachBody.prototype.bind = function (decorated, container, $container) {\n    var self = this;\n\n    decorated.call(this, container, $container);\n\n    container.on('open', function () {\n      self._showDropdown();\n      self._attachPositioningHandler(container);\n\n      // Must bind after the results handlers to ensure correct sizing\n      self._bindContainerResultHandlers(container);\n    });\n\n    container.on('close', function () {\n      self._hideDropdown();\n      self._detachPositioningHandler(container);\n    });\n\n    this.$dropdownContainer.on('mousedown', function (evt) {\n      evt.stopPropagation();\n    });\n  };\n\n  AttachBody.prototype.destroy = function (decorated) {\n    decorated.call(this);\n\n    this.$dropdownContainer.remove();\n  };\n\n  AttachBody.prototype.position = function (decorated, $dropdown, $container) {\n    // Clone all of the container classes\n    $dropdown.attr('class', $container.attr('class'));\n\n    $dropdown.removeClass('select2');\n    $dropdown.addClass('select2-container--open');\n\n    $dropdown.css({\n      position: 'absolute',\n      top: -999999\n    });\n\n    this.$container = $container;\n  };\n\n  AttachBody.prototype.render = function (decorated) {\n    var $container = $('<span></span>');\n\n    var $dropdown = decorated.call(this);\n    $container.append($dropdown);\n\n    this.$dropdownContainer = $container;\n\n    return $container;\n  };\n\n  AttachBody.prototype._hideDropdown = function (decorated) {\n    this.$dropdownContainer.detach();\n  };\n\n  AttachBody.prototype._bindContainerResultHandlers =\n      function (decorated, container) {\n\n    // These should only be bound once\n    if (this._containerResultsHandlersBound) {\n      return;\n    }\n\n    var self = this;\n\n    container.on('results:all', function () {\n      self._positionDropdown();\n      self._resizeDropdown();\n    });\n\n    container.on('results:append', function () {\n      self._positionDropdown();\n      self._resizeDropdown();\n    });\n\n    container.on('results:message', function () {\n      self._positionDropdown();\n      self._resizeDropdown();\n    });\n\n    container.on('select', function () {\n      self._positionDropdown();\n      self._resizeDropdown();\n    });\n\n    container.on('unselect', function () {\n      self._positionDropdown();\n      self._resizeDropdown();\n    });\n\n    this._containerResultsHandlersBound = true;\n  };\n\n  AttachBody.prototype._attachPositioningHandler =\n      function (decorated, container) {\n    var self = this;\n\n    var scrollEvent = 'scroll.select2.' + container.id;\n    var resizeEvent = 'resize.select2.' + container.id;\n    var orientationEvent = 'orientationchange.select2.' + container.id;\n\n    var $watchers = this.$container.parents().filter(Utils.hasScroll);\n    $watchers.each(function () {\n      Utils.StoreData(this, 'select2-scroll-position', {\n        x: $(this).scrollLeft(),\n        y: $(this).scrollTop()\n      });\n    });\n\n    $watchers.on(scrollEvent, function (ev) {\n      var position = Utils.GetData(this, 'select2-scroll-position');\n      $(this).scrollTop(position.y);\n    });\n\n    $(window).on(scrollEvent + ' ' + resizeEvent + ' ' + orientationEvent,\n      function (e) {\n      self._positionDropdown();\n      self._resizeDropdown();\n    });\n  };\n\n  AttachBody.prototype._detachPositioningHandler =\n      function (decorated, container) {\n    var scrollEvent = 'scroll.select2.' + container.id;\n    var resizeEvent = 'resize.select2.' + container.id;\n    var orientationEvent = 'orientationchange.select2.' + container.id;\n\n    var $watchers = this.$container.parents().filter(Utils.hasScroll);\n    $watchers.off(scrollEvent);\n\n    $(window).off(scrollEvent + ' ' + resizeEvent + ' ' + orientationEvent);\n  };\n\n  AttachBody.prototype._positionDropdown = function () {\n    var $window = $(window);\n\n    var isCurrentlyAbove = this.$dropdown.hasClass('select2-dropdown--above');\n    var isCurrentlyBelow = this.$dropdown.hasClass('select2-dropdown--below');\n\n    var newDirection = null;\n\n    var offset = this.$container.offset();\n\n    offset.bottom = offset.top + this.$container.outerHeight(false);\n\n    var container = {\n      height: this.$container.outerHeight(false)\n    };\n\n    container.top = offset.top;\n    container.bottom = offset.top + container.height;\n\n    var dropdown = {\n      height: this.$dropdown.outerHeight(false)\n    };\n\n    var viewport = {\n      top: $window.scrollTop(),\n      bottom: $window.scrollTop() + $window.height()\n    };\n\n    var enoughRoomAbove = viewport.top < (offset.top - dropdown.height);\n    var enoughRoomBelow = viewport.bottom > (offset.bottom + dropdown.height);\n\n    var css = {\n      left: offset.left,\n      top: container.bottom\n    };\n\n    // Determine what the parent element is to use for calculating the offset\n    var $offsetParent = this.$dropdownParent;\n\n    // For statically positioned elements, we need to get the element\n    // that is determining the offset\n    if ($offsetParent.css('position') === 'static') {\n      $offsetParent = $offsetParent.offsetParent();\n    }\n\n    var parentOffset = {\n      top: 0,\n      left: 0\n    };\n\n    if (\n      $.contains(document.body, $offsetParent[0]) ||\n      $offsetParent[0].isConnected\n      ) {\n      parentOffset = $offsetParent.offset();\n    }\n\n    css.top -= parentOffset.top;\n    css.left -= parentOffset.left;\n\n    if (!isCurrentlyAbove && !isCurrentlyBelow) {\n      newDirection = 'below';\n    }\n\n    if (!enoughRoomBelow && enoughRoomAbove && !isCurrentlyAbove) {\n      newDirection = 'above';\n    } else if (!enoughRoomAbove && enoughRoomBelow && isCurrentlyAbove) {\n      newDirection = 'below';\n    }\n\n    if (newDirection == 'above' ||\n      (isCurrentlyAbove && newDirection !== 'below')) {\n      css.top = container.top - parentOffset.top - dropdown.height;\n    }\n\n    if (newDirection != null) {\n      this.$dropdown\n        .removeClass('select2-dropdown--below select2-dropdown--above')\n        .addClass('select2-dropdown--' + newDirection);\n      this.$container\n        .removeClass('select2-container--below select2-container--above')\n        .addClass('select2-container--' + newDirection);\n    }\n\n    this.$dropdownContainer.css(css);\n  };\n\n  AttachBody.prototype._resizeDropdown = function () {\n    var css = {\n      width: this.$container.outerWidth(false) + 'px'\n    };\n\n    if (this.options.get('dropdownAutoWidth')) {\n      css.minWidth = css.width;\n      css.position = 'relative';\n      css.width = 'auto';\n    }\n\n    this.$dropdown.css(css);\n  };\n\n  AttachBody.prototype._showDropdown = function (decorated) {\n    this.$dropdownContainer.appendTo(this.$dropdownParent);\n\n    this._positionDropdown();\n    this._resizeDropdown();\n  };\n\n  return AttachBody;\n});\n"]},"metadata":{},"sourceType":"module"}